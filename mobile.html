<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MillBrook Pizza - Mobile Optimized</title>
    <link rel="stylesheet" href="css/mobile-first.css">
    <meta name="theme-color" content="#d32f2f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <style>
        /* Additional mobile-specific styles */
        @media (min-width: 768px) {
            header .container {
                flex-direction: row;
                justify-content: space-between;
                position: relative;
            }

            .header-buttons {
                flex-direction: row;
                margin-top: 0;
                width: auto;
            }

            .header-phone,
            .header-order {
                width: auto;
                max-width: none;
            }

            .header-order {
                margin-left: 0.5rem;
            }

            .header-cart {
                position: static;
                margin-left: 1rem;
            }
        }

        .mobile-navbar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
            z-index: 100;
        }

        .mobile-navbar ul {
            display: flex;
            justify-content: space-around;
            padding: 0.75rem 0;
        }

        .mobile-navbar a {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 0.8rem;
        }

        .mobile-navbar .icon {
            font-size: 1.5rem;
            margin-bottom: 0.25rem;
        }

        .mobile-navbar .active {
            color: var(--primary-color);
        }

        /* Add padding to avoid content being hidden by bottom nav */
        body {
            padding-bottom: 70px;
        }

        /* Header with phone number */
        header {
            padding: 1rem 0;
        }

        header .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .header-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 0.5rem;
            width: 100%;
            gap: 0.5rem;
        }

        .header-phone,
        .header-order {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: bold;
            text-decoration: none;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            transition: all 0.2s ease;
            width: 100%;
            max-width: 200px;
        }

        .header-phone {
            background-color: var(--primary-color);
        }

        .header-order {
            background-color: var(--secondary-color);
        }

        .header-phone:hover,
        .header-phone:active,
        .header-order:hover,
        .header-order:active {
            transform: scale(1.05);
            opacity: 0.9;
        }

        .phone-icon,
        .order-icon {
            margin-right: 0.5rem;
        }

        .header-cart {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: white;
            border: none;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .cart-count {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--primary-color);
            color: white;
            font-size: 0.7rem;
            width: 1.2rem;
            height: 1.2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Hide desktop navbar */
        header nav {
            display: none;
        }

        /* Better touch targets */
        .btn,
        button,
        .menu-item button {
            min-height: 44px;
        }

        input,
        select {
            min-height: 44px;
            font-size: 16px;
            /* Prevent iOS zoom */
        }

        /* Simplified cart for mobile */
        .cart-mobile {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            z-index: 200;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
        }

        .cart-mobile.active {
            transform: translateY(0);
        }

        .cart-mobile-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
        }

        .cart-mobile-close {
            font-size: 1.5rem;
            background: none;
            border: none;
        }

        /* Overlay when cart is open */
        .mobile-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 199;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .mobile-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* Custom Pizza Modal */
        .custom-pizza-modal {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            z-index: 300;
            transform: translateY(100%);
            transition: transform 0.3s ease;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
            border-radius: 15px 15px 0 0;
        }

        .custom-pizza-modal.active {
            transform: translateY(0);
        }

        .custom-pizza-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-bottom: 1px solid #eee;
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
        }

        .custom-pizza-close {
            font-size: 1.5rem;
            background: none;
            border: none;
            cursor: pointer;
        }

        .custom-pizza-content {
            padding: 1rem;
        }

        .custom-pizza-step {
            margin-bottom: 1rem;
        }

        .custom-pizza-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 1rem 0;
        }

        .custom-option {
            width: calc(50% - 5px);
        }

        .custom-option input[type="radio"] {
            display: none;
        }

        .custom-option label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            border: 2px solid #eee;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            height: 100px;
        }

        .custom-option input[type="radio"]:checked+label {
            border-color: var(--primary-color);
            background-color: rgba(211, 47, 47, 0.1);
        }

        .option-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .option-label {
            font-weight: bold;
        }

        .step-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
        }

        .step-buttons button {
            min-width: 48%;
        }

        .btn-next,
        .btn-add-cart {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-prev {
            background-color: #f5f5f5;
            color: #333;
        }

        .toppings-grid {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .topping-category {
            width: 100%;
        }

        .topping-option {
            margin: 0.5rem 0;
        }

        .topping-option label {
            margin-left: 0.5rem;
        }

        .toppings-note {
            font-style: italic;
            color: #666;
            font-size: 0.9rem;
        }

        .custom-pizza-summary {
            margin-top: 1rem;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: 5px;
            font-weight: bold;
        }

        .cart-pickup-notice {
            background-color: #f5f5f5;
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .cart-pickup-notice p {
            margin: 5px 0;
        }

        .cart-pickup-notice strong {
            color: var(--primary-color);
        }

        .cart-checkout-options {
            padding: 0 1rem;
        }

        .payment-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        .payment-option {
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .payment-option:hover {
            border-color: var(--primary-color);
        }

        .payment-option input[type="radio"] {
            margin-right: 10px;
        }

        .payment-option input[type="radio"]:checked+label {
            font-weight: bold;
            color: var(--primary-color);
        }

        .payment-option input[type="radio"]:checked~.payment-details {
            display: block;
        }

        .payment-details {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px dashed #eee;
            color: #666;
            font-size: 0.9rem;
            display: none;
        }

        .payment-icons,
        .card-icons {
            font-size: 1.5rem;
            margin-bottom: 5px;
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .order-summary {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }

        .summary-total {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            font-weight: bold;
        }

        .pickup-info {
            margin: 20px 0;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }

        #order-confirmation {
            text-align: center;
            padding: 20px 0;
        }

        .confirmation-icon {
            font-size: 3rem;
            color: green;
            margin-bottom: 15px;
        }

        #order-details {
            margin: 20px 0;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            text-align: left;
        }

        #payment-method-conf {
            margin-top: 20px;
            font-style: italic;
        }

        /* Remove the cart from header */
        .header-cart {
            display: none;
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <h1>MillBrook Pizza</h1>
            <div class="header-buttons">
                <a href="tel:5551234567" class="header-phone">
                    <span class="phone-icon">📞</span> Call
                </a>
                <a href="#" class="header-order" id="custom-pizza-btn">
                    <span class="order-icon">🍕</span> Order Online
                </a>
            </div>
        </div>
    </header>

    <section id="home" class="hero">
        <div class="container">
            <h2>Fresh, Delicious Pizza</h2>
            <p>Order online for quick and easy takeout</p>
            <a href="#menu" class="btn">View Menu</a>
        </div>
    </section>

    <section id="menu" class="menu-section">
        <div class="container">
            <h2>Our Menu</h2>

            <!-- Classic Pizzas -->
            <div class="category-section">
                <h3>Classic Pizzas</h3>
                <div class="menu-items-grid">
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPk1hcmdoZXJpdGE8L3RleHQ+PC9zdmc+"
                            alt="Margherita">
                        <div class="menu-item-content">
                            <h3>Classic Margherita</h3>
                            <p>Fresh mozzarella, tomato sauce, fresh basil</p>
                            <p class="price">$12.99</p>
                            <button class="btn add-to-cart" data-id="1">Add to Cart</button>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPlBlcHBlcm9uaTwvdGV4dD48L3N2Zz4="
                            alt="Pepperoni">
                        <div class="menu-item-content">
                            <h3>Pepperoni</h3>
                            <p>Pepperoni, mozzarella, tomato sauce</p>
                            <p class="price">$14.99</p>
                            <button class="btn add-to-cart" data-id="2">Add to Cart</button>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPkhhd2FpaWFuPC90ZXh0Pjwvc3ZnPg=="
                            alt="Hawaiian">
                        <div class="menu-item-content">
                            <h3>Hawaiian</h3>
                            <p>Ham, pineapple, mozzarella, tomato sauce</p>
                            <p class="price">$14.99</p>
                            <button class="btn add-to-cart" data-id="3">Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Specialty Pizzas -->
            <div class="category-section">
                <h3>Specialty Pizzas</h3>
                <div class="menu-items-grid">
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPk1lZWF0IExvdmVyczwvdGV4dD48L3N2Zz4="
                            alt="Meat Lovers">
                        <div class="menu-item-content">
                            <h3>Meat Lovers</h3>
                            <p>Pepperoni, sausage, bacon, ham, mozzarella, tomato sauce</p>
                            <p class="price">$16.99</p>
                            <button class="btn add-to-cart" data-id="4">Add to Cart</button>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPlZlZ2dpZTwvdGV4dD48L3N2Zz4="
                            alt="Veggie Supreme">
                        <div class="menu-item-content">
                            <h3>Veggie Supreme</h3>
                            <p>Bell peppers, onions, mushrooms, olives, tomatoes, mozzarella, tomato sauce</p>
                            <p class="price">$15.99</p>
                            <button class="btn add-to-cart" data-id="5">Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sides -->
            <div class="category-section">
                <h3>Sides</h3>
                <div class="menu-items-grid">
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPkdhcmxpYyBLbm90czwvdGV4dD48L3N2Zz4="
                            alt="Garlic Knots">
                        <div class="menu-item-content">
                            <h3>Garlic Knots</h3>
                            <p>6 knots with garlic butter and parmesan</p>
                            <p class="price">$5.99</p>
                            <button class="btn add-to-cart" data-id="6">Add to Cart</button>
                        </div>
                    </div>
                    <div class="menu-item">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1zbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwiIGZvbnQtc2l6ZT0iMjAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZpbGw9IiM5OTkiPldpbmdzPC90ZXh0Pjwvc3ZnPg=="
                            alt="Buffalo Wings">
                        <div class="menu-item-content">
                            <h3>Buffalo Wings</h3>
                            <p>8 wings with blue cheese dressing</p>
                            <p class="price">$9.99</p>
                            <button class="btn add-to-cart" data-id="7">Add to Cart</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="contact" class="contact-section">
        <div class="container">
            <h2>Contact Us</h2>
            <div class="contact-info">
                <div>
                    <h3>Address</h3>
                    <p>123 Main Street<br>MillBrook, NY 12345</p>
                </div>
                <div>
                    <h3>Hours</h3>
                    <p>Monday - Thursday: 11am - 9pm<br>
                        Friday - Saturday: 11am - 10pm<br>
                        Sunday: 12pm - 8pm</p>
                </div>
                <div>
                    <h3>Phone</h3>
                    <p><a href="tel:5551234567">(555) 123-4567</a></p>
                </div>
                <div>
                    <h3>Facebook</h3>
                    <p><a href="https://www.facebook.com/groups/1497554914250717" target="_blank">Join Our Community</a>
                    </p>
                </div>
            </div>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2025 MillBrook Pizza. All rights reserved.</p>
        </div>
    </footer>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-navbar">
        <ul>
            <li>
                <a href="#home" class="active">
                    <div class="icon">🏠</div>
                    Home
                </a>
            </li>
            <li>
                <a href="#menu">
                    <div class="icon">🍕</div>
                    Menu
                </a>
            </li>
            <li>
                <a href="#contact">
                    <div class="icon">📞</div>
                    Contact
                </a>
            </li>
            <li>
                <a href="#" id="cart-link">
                    <div class="icon">🛒</div>
                    Cart
                    <span class="navbar-cart-count" id="navbar-cart-count">0</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Cart button is now in the header, removing floating button -->

    <!-- Mobile Cart Slide-up -->
    <div class="mobile-overlay" id="cart-overlay"></div>
    <div class="cart-mobile" id="mobile-cart">
        <div class="cart-mobile-header">
            <h3>Your Order</h3>
            <button class="cart-mobile-close" id="close-cart">✖</button>
        </div>
        <div id="mobile-cart-items">
            <!-- Cart items will be loaded here -->
            <div class="cart-item">
                <div class="cart-item-details">
                    <h4>No items in cart</h4>
                    <p>Add some pizzas to get started!</p>
                </div>
            </div>
        </div>
        <div class="cart-total">
            <p>Total: $<span id="mobile-cart-total">0.00</span></p>
        </div>
        <div class="cart-pickup-notice">
            <p><strong>PICKUP ONLY</strong> - We do not offer delivery service</p>
            <p>Est. pickup time: <span id="pickup-time">30-45 minutes</span></p>
        </div>
        <div class="cart-checkout-options">
            <h4>Choose Payment Method:</h4>
            <div class="payment-options">
                <div class="payment-option">
                    <input type="radio" id="pay-online" name="payment-method" value="online" checked>
                    <label for="pay-online">Pay Online</label>
                    <div class="payment-details">
                        <span class="card-icons">💳</span>
                        <p>Secure payment via credit/debit card</p>
                    </div>
                </div>
                <div class="payment-option">
                    <input type="radio" id="pay-store" name="payment-method" value="store">
                    <label for="pay-store">Pay at Store</label>
                    <div class="payment-details">
                        <span class="payment-icons">💵 💳 💲</span>
                        <p>Cash, Debit, or Credit Card accepted</p>
                    </div>
                </div>
            </div>
        </div>
        <div style="padding: 1rem;">
            <button id="mobile-checkout-btn" class="btn">Proceed to Checkout</button>
        </div>
    </div>

    <!-- Payment Processing Modal -->
    <div class="mobile-overlay" id="payment-overlay"></div>
    <div class="custom-pizza-modal" id="payment-modal">
        <div class="custom-pizza-header">
            <h3>Complete Your Order</h3>
            <button class="custom-pizza-close" id="close-payment">✖</button>
        </div>

        <div class="custom-pizza-content" id="payment-content">
            <div id="online-payment-form" style="display: none;">
                <h4>Payment Information</h4>
                <div id="card-element">
                    <!-- Stripe Card Element will be inserted here -->
                </div>
                <div id="card-errors" role="alert"></div>

                <h4>Contact Information</h4>
                <div class="form-group">
                    <label for="customer-name">Your Name</label>
                    <input type="text" id="customer-name" placeholder="Full Name" required>
                </div>
                <div class="form-group">
                    <label for="customer-phone">Phone Number</label>
                    <input type="tel" id="customer-phone" placeholder="For pickup notifications" required>
                </div>
                <div class="form-group">
                    <label for="customer-email">Email (optional)</label>
                    <input type="email" id="customer-email" placeholder="For receipt">
                </div>

                <button id="submit-payment" class="btn btn-next">Pay Now</button>
            </div>

            <div id="store-payment-form">
                <h4>Order Information</h4>
                <div class="form-group">
                    <label for="customer-name-store">Your Name</label>
                    <input type="text" id="customer-name-store" placeholder="Full Name" required>
                </div>
                <div class="form-group">
                    <label for="customer-phone-store">Phone Number</label>
                    <input type="tel" id="customer-phone-store" placeholder="For pickup notifications" required>
                </div>

                <div class="order-summary">
                    <h4>Order Summary</h4>
                    <div id="summary-items">
                        <!-- Order summary items will be added here -->
                    </div>
                    <div class="summary-total">
                        <p>Total: $<span id="summary-total">0.00</span></p>
                    </div>
                </div>

                <div class="pickup-info">
                    <h4>Pickup Information</h4>
                    <p>Your order will be ready for pickup in approximately <span id="summary-pickup-time">30-45
                            minutes</span>.</p>
                    <p>Please bring your phone to the store. You will pay using cash, debit, or credit card when you
                        arrive.</p>
                </div>

                <button id="submit-store-order" class="btn btn-next">Place Order</button>
            </div>

            <div id="order-confirmation" style="display: none;">
                <div class="confirmation-icon">✅</div>
                <h3>Order Confirmed!</h3>
                <p>Your order has been placed successfully.</p>
                <div id="order-details">
                    <p><strong>Order Number:</strong> <span id="order-number"></span></p>
                    <p><strong>Pickup Time:</strong> <span id="conf-pickup-time"></span></p>
                </div>
                <p>We'll send a notification to your phone when your order is ready.</p>
                <div id="payment-method-conf"></div>
                <button id="close-confirmation" class="btn">Done</button>
            </div>
        </div>
    </div>

    <!-- Custom Pizza Modal -->
    <div class="mobile-overlay" id="custom-pizza-overlay"></div>
    <div class="custom-pizza-modal" id="custom-pizza-modal">
        <div class="custom-pizza-header">
            <h3>Build Your Custom Pizza</h3>
            <button class="custom-pizza-close" id="close-custom-pizza">✖</button>
        </div>

        <div class="custom-pizza-content">
            <!-- Step 1: Choose Crust -->
            <div class="custom-pizza-step" id="step-1">
                <h4>Step 1: Choose Your Crust</h4>
                <div class="custom-pizza-options">
                    <div class="custom-option">
                        <input type="radio" name="crust" id="crust-thin" value="Thin" checked>
                        <label for="crust-thin">
                            <div class="option-icon">🥖</div>
                            <div class="option-label">Thin Crust</div>
                        </label>
                    </div>
                    <div class="custom-option">
                        <input type="radio" name="crust" id="crust-regular" value="Regular">
                        <label for="crust-regular">
                            <div class="option-icon">🍞</div>
                            <div class="option-label">Regular Crust</div>
                        </label>
                    </div>
                    <div class="custom-option">
                        <input type="radio" name="crust" id="crust-thick" value="Thick">
                        <label for="crust-thick">
                            <div class="option-icon">🥯</div>
                            <div class="option-label">Thick Crust</div>
                        </label>
                    </div>
                    <div class="custom-option">
                        <input type="radio" name="crust" id="crust-gluten-free" value="Gluten-Free">
                        <label for="crust-gluten-free">
                            <div class="option-icon">🌾</div>
                            <div class="option-label">Gluten-Free (+$2)</div>
                        </label>
                    </div>
                </div>
                <div class="step-buttons">
                    <button class="btn btn-next" id="next-to-size">Next: Choose Size</button>
                </div>
            </div>

            <!-- Step 2: Choose Size -->
            <div class="custom-pizza-step" id="step-2" style="display: none;">
                <h4>Step 2: Choose Your Size</h4>
                <div class="custom-pizza-options">
                    <div class="custom-option">
                        <input type="radio" name="size" id="size-small" value="Small" checked>
                        <label for="size-small">
                            <div class="option-icon">🍕</div>
                            <div class="option-label">Small (10") - $10.99</div>
                        </label>
                    </div>
                    <div class="custom-option">
                        <input type="radio" name="size" id="size-medium" value="Medium">
                        <label for="size-medium">
                            <div class="option-icon">🍕</div>
                            <div class="option-label">Medium (12") - $13.99</div>
                        </label>
                    </div>
                    <div class="custom-option">
                        <input type="radio" name="size" id="size-large" value="Large">
                        <label for="size-large">
                            <div class="option-icon">🍕</div>
                            <div class="option-label">Large (14") - $16.99</div>
                        </label>
                    </div>
                    <div class="custom-option">
                        <input type="radio" name="size" id="size-xlarge" value="Extra Large">
                        <label for="size-xlarge">
                            <div class="option-icon">🍕</div>
                            <div class="option-label">Extra Large (16") - $19.99</div>
                        </label>
                    </div>
                </div>
                <div class="step-buttons">
                    <button class="btn btn-prev" id="back-to-crust">Back: Choose Crust</button>
                    <button class="btn btn-next" id="next-to-toppings">Next: Choose Toppings</button>
                </div>
            </div>

            <!-- Step 3: Choose Toppings -->
            <div class="custom-pizza-step" id="step-3" style="display: none;">
                <h4>Step 3: Choose Your Toppings</h4>
                <p class="toppings-note">First 3 toppings included, additional toppings +$1.50 each</p>
                <div class="custom-pizza-options toppings-grid">
                    <!-- Meats -->
                    <div class="topping-category">
                        <h5>Meats</h5>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-pepperoni" value="Pepperoni">
                            <label for="topping-pepperoni">Pepperoni</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-sausage" value="Sausage">
                            <label for="topping-sausage">Sausage</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-bacon" value="Bacon">
                            <label for="topping-bacon">Bacon</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-ham" value="Ham">
                            <label for="topping-ham">Ham</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-chicken" value="Chicken">
                            <label for="topping-chicken">Chicken</label>
                        </div>
                    </div>

                    <!-- Veggies -->
                    <div class="topping-category">
                        <h5>Veggies</h5>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-mushrooms" value="Mushrooms">
                            <label for="topping-mushrooms">Mushrooms</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-onions" value="Onions">
                            <label for="topping-onions">Onions</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-peppers" value="Bell Peppers">
                            <label for="topping-peppers">Bell Peppers</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-olives" value="Black Olives">
                            <label for="topping-olives">Black Olives</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-tomatoes" value="Tomatoes">
                            <label for="topping-tomatoes">Tomatoes</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-spinach" value="Spinach">
                            <label for="topping-spinach">Spinach</label>
                        </div>
                        <div class="topping-option">
                            <input type="checkbox" name="toppings" id="topping-pineapple" value="Pineapple">
                            <label for="topping-pineapple">Pineapple</label>
                        </div>
                    </div>
                </div>
                <div class="custom-pizza-summary">
                    <div id="current-price">Current Price: $10.99</div>
                    <div id="selected-toppings">Selected Toppings: 0/3 included</div>
                </div>
                <div class="step-buttons">
                    <button class="btn btn-prev" id="back-to-size">Back: Choose Size</button>
                    <button class="btn btn-add-cart" id="add-custom-pizza">Add to Cart</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Make cart globally accessible
        let cart;

        document.addEventListener('DOMContentLoaded', function () {
            // Cart object to manage cart state
            cart = {
                items: [],
                total: 0,

                addItem: function (id, name, price) {
                    const existingItem = this.items.find(item => item.id === id);

                    if (existingItem) {
                        // Item already exists in cart, increase quantity
                        existingItem.quantity++;
                        existingItem.subtotal = existingItem.price * existingItem.quantity;
                    } else {
                        // New item, add to cart
                        this.items.push({
                            id: id,
                            name: name,
                            price: price,
                            quantity: 1,
                            subtotal: price
                        });
                    }

                    this.updateTotal();
                    this.updateCartDisplay();
                },

                removeItem: function (id) {
                    this.items = this.items.filter(item => item.id !== id);
                    this.updateTotal();
                    this.updateCartDisplay();
                },

                updateQuantity: function (id, quantity) {
                    const item = this.items.find(item => item.id === id);

                    if (item) {
                        if (quantity <= 0) {
                            this.removeItem(id);
                            return;
                        }

                        item.quantity = quantity;
                        item.subtotal = item.price * item.quantity;
                        this.updateTotal();
                        this.updateCartDisplay();
                    }
                },

                updateTotal: function () {
                    this.total = this.items.reduce((total, item) => total + item.subtotal, 0);
                },

                updateCartDisplay: function () {
                    // Update count badges
                    const navbarCartCount = document.getElementById('navbar-cart-count');
                    const itemCount = this.items.reduce((count, item) => count + item.quantity, 0);
                    
                    if (navbarCartCount) {
                        navbarCartCount.textContent = itemCount;
                    }

                    // Update mobile cart
                    const mobileCartItems = document.getElementById('mobile-cart-items');
                    const mobileCartTotal = document.getElementById('mobile-cart-total');

                    // Clear current items
                    mobileCartItems.innerHTML = '';

                    if (this.items.length === 0) {
                        mobileCartItems.innerHTML = `
                            <div class="cart-item">
                                <div class="cart-item-details">
                                    <h4>No items in cart</h4>
                                    <p>Add some pizzas to get started!</p>
                                </div>
                            </div>
                        `;
                    } else {
                        // Add each item to the cart
                        this.items.forEach(item => {
                            const cartItem = document.createElement('div');
                            cartItem.className = 'cart-item';

                            cartItem.innerHTML = `
                                <div class="cart-item-details">
                                    <h4>${item.name}</h4>
                                    <p>$${item.price.toFixed(2)} × ${item.quantity}</p>
                                </div>
                                <div class="cart-item-actions">
                                    <span class="cart-item-subtotal">$${item.subtotal.toFixed(2)}</span>
                                    <div class="quantity-controls">
                                        <button class="btn-decrease" data-id="${item.id}">-</button>
                                        <span class="quantity">${item.quantity}</span>
                                        <button class="btn-increase" data-id="${item.id}">+</button>
                                    </div>
                                    <button class="btn-remove" data-id="${item.id}">×</button>
                                </div>
                            `;

                            mobileCartItems.appendChild(cartItem);
                        });

                        // Add event listeners for cart controls
                        mobileCartItems.querySelectorAll('.btn-decrease').forEach(btn => {
                            btn.addEventListener('click', () => {
                                const id = parseInt(btn.getAttribute('data-id'));
                                const item = this.items.find(item => item.id === id);
                                if (item) {
                                    this.updateQuantity(id, item.quantity - 1);
                                }
                            });
                        });

                        mobileCartItems.querySelectorAll('.btn-increase').forEach(btn => {
                            btn.addEventListener('click', () => {
                                const id = parseInt(btn.getAttribute('data-id'));
                                const item = this.items.find(item => item.id === id);
                                if (item) {
                                    this.updateQuantity(id, item.quantity + 1);
                                }
                            });
                        });

                        mobileCartItems.querySelectorAll('.btn-remove').forEach(btn => {
                            btn.addEventListener('click', () => {
                                const id = parseInt(btn.getAttribute('data-id'));
                                this.removeItem(id);
                            });
                        });
                    }

                    // Update total
                    mobileCartTotal.textContent = this.total.toFixed(2);

                    // Update checkout button
                    const checkoutBtn = document.getElementById('mobile-checkout-btn');
                    checkoutBtn.disabled = this.items.length === 0;
                }
            };

            // Add to cart buttons
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', function () {
                    const id = parseInt(this.getAttribute('data-id'));
                    const name = this.closest('.menu-item').querySelector('h3').textContent;
                    const priceText = this.closest('.menu-item').querySelector('.price').textContent;
                    const price = parseFloat(priceText.replace('$', ''));

                    cart.addItem(id, name, price);

                    // Show added animation
                    const addedMsg = document.createElement('div');
                    addedMsg.className = 'added-to-cart';
                    addedMsg.textContent = 'Added to cart!';
                    document.body.appendChild(addedMsg);

                    setTimeout(() => {
                        addedMsg.remove();
                    }, 2000);
                });
            });

            // Mobile cart toggle
            const cartLink = document.getElementById('cart-link');
            const mobileCart = document.getElementById('mobile-cart');
            const cartOverlay = document.getElementById('cart-overlay');
            const closeCart = document.getElementById('close-cart');

            cartLink.addEventListener('click', (e) => {
                e.preventDefault();
                mobileCart.classList.add('active');
                cartOverlay.classList.add('active');
                document.body.style.overflow = 'hidden'; // Prevent scrolling
            });

            closeCart.addEventListener('click', () => {
                mobileCart.classList.remove('active');
                cartOverlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            cartOverlay.addEventListener('click', () => {
                mobileCart.classList.remove('active');
                cartOverlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            // Mobile nav active state
            const navLinks = document.querySelectorAll('.mobile-navbar a');

            navLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    // Remove active class from all links
                    navLinks.forEach(link => link.classList.remove('active'));

                    // Add active class to clicked link
                    this.classList.add('active');

                    // If checkout link is clicked
                    if (this.id === 'checkout-link') {
                        e.preventDefault();

                        // Only proceed if cart has items
                        if (cart.items.length > 0) {
                            // Show checkout process (simplified for demo)
                            alert('Checkout feature would open here with ' + cart.items.length + ' items totaling $' + cart.total.toFixed(2));
                        } else {
                            alert('Please add items to your cart before checking out');
                        }
                    }
                });
            });

            // Checkout button
            document.getElementById('mobile-checkout-btn').addEventListener('click', () => {
                // Only proceed if cart has items
                if (cart.items.length > 0) {
                    // Close the cart drawer
                    mobileCart.classList.remove('active');
                    cartOverlay.classList.remove('active');

                    // Show payment modal
                    const paymentModal = document.getElementById('payment-modal');
                    const paymentOverlay = document.getElementById('payment-overlay');
                    const paymentMethod = document.querySelector('input[name="payment-method"]:checked').value;

                    // Show appropriate payment form
                    if (paymentMethod === 'online') {
                        document.getElementById('online-payment-form').style.display = 'block';
                        document.getElementById('store-payment-form').style.display = 'none';
                    } else {
                        document.getElementById('online-payment-form').style.display = 'none';
                        document.getElementById('store-payment-form').style.display = 'block';

                        // Fill order summary
                        const summaryItems = document.getElementById('summary-items');
                        summaryItems.innerHTML = '';

                        cart.items.forEach(item => {
                            const itemEl = document.createElement('div');
                            itemEl.className = 'summary-item';
                            itemEl.innerHTML = `
                                <p>${item.name} × ${item.quantity} <span>$${item.subtotal.toFixed(2)}</span></p>
                            `;
                            summaryItems.appendChild(itemEl);
                        });

                        document.getElementById('summary-total').textContent = cart.total.toFixed(2);
                    }

                    paymentModal.classList.add('active');
                    paymentOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden'; // Prevent scrolling
                }
            });

            // Toggle payment methods
            const paymentOptions = document.querySelectorAll('input[name="payment-method"]');
            paymentOptions.forEach(option => {
                option.addEventListener('change', function () {
                    document.querySelectorAll('.payment-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    this.closest('.payment-option').classList.add('selected');
                });
            });

            // Make first payment option selected by default
            document.querySelector('.payment-option').classList.add('selected');

            // Close payment modal
            document.getElementById('close-payment').addEventListener('click', function () {
                const paymentModal = document.getElementById('payment-modal');
                const paymentOverlay = document.getElementById('payment-overlay');

                paymentModal.classList.remove('active');
                paymentOverlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            document.getElementById('payment-overlay').addEventListener('click', function () {
                const paymentModal = document.getElementById('payment-modal');

                paymentModal.classList.remove('active');
                this.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            // Handle pay at store submission
            document.getElementById('submit-store-order').addEventListener('click', function () {
                const customerName = document.getElementById('customer-name-store').value;
                const customerPhone = document.getElementById('customer-phone-store').value;

                if (!customerName || !customerPhone) {
                    alert('Please fill in your name and phone number');
                    return;
                }

                // Generate random order number
                const orderNumber = 'M' + Math.floor(1000 + Math.random() * 9000);

                // For a real app, you would send this data to a server
                // For now, we'll just show the confirmation
                document.getElementById('order-number').textContent = orderNumber;
                document.getElementById('conf-pickup-time').textContent = document.getElementById('summary-pickup-time').textContent;
                document.getElementById('payment-method-conf').innerHTML =
                    '<p>Please pay <strong>$' + cart.total.toFixed(2) + '</strong> at the store when you pick up your order.</p>' +
                    '<p>We accept cash, debit and major credit cards.</p>';

                // Hide forms, show confirmation
                document.getElementById('online-payment-form').style.display = 'none';
                document.getElementById('store-payment-form').style.display = 'none';
                document.getElementById('order-confirmation').style.display = 'block';

                // Clear cart
                cart.items = [];
                cart.total = 0;
                cart.updateCartDisplay();
            });

            // Handle online payment submission
            document.getElementById('submit-payment').addEventListener('click', function () {
                const customerName = document.getElementById('customer-name').value;
                const customerPhone = document.getElementById('customer-phone').value;

                if (!customerName || !customerPhone) {
                    alert('Please fill in your name and phone number');
                    return;
                }

                // In a real app, you would process the payment with Stripe here
                // For this demo, we'll just show success

                // Generate random order number
                const orderNumber = 'M' + Math.floor(1000 + Math.random() * 9000);

                // Show confirmation
                document.getElementById('order-number').textContent = orderNumber;
                document.getElementById('conf-pickup-time').textContent = document.getElementById('pickup-time').textContent;
                document.getElementById('payment-method-conf').innerHTML =
                    '<p>Your card has been charged <strong>$' + cart.total.toFixed(2) + '</strong>.</p>' +
                    '<p>A receipt has been sent to your email (if provided).</p>';

                // Hide forms, show confirmation
                document.getElementById('online-payment-form').style.display = 'none';
                document.getElementById('store-payment-form').style.display = 'none';
                document.getElementById('order-confirmation').style.display = 'block';

                // Clear cart
                cart.items = [];
                cart.total = 0;
                cart.updateCartDisplay();
            });

            // Close confirmation and modal
            document.getElementById('close-confirmation').addEventListener('click', function () {
                const paymentModal = document.getElementById('payment-modal');
                const paymentOverlay = document.getElementById('payment-overlay');

                // Reset form views for next time
                document.getElementById('order-confirmation').style.display = 'none';

                paymentModal.classList.remove('active');
                paymentOverlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            // Initialize cart display
            cart.updateCartDisplay();

            // Smooth scrolling for navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    if (this.getAttribute('href') === '#checkout') return; // Skip checkout link

                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));

                    if (target) {
                        window.scrollTo({
                            top: target.offsetTop,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });

        // Fix the cart functionality by updating this section of the script

        // Update to properly position the cart count badge in navbar
        document.addEventListener('DOMContentLoaded', function() {
            // Add CSS fix for navbar cart count position
            const style = document.createElement('style');
            style.textContent = `
                .mobile-navbar li {
                    position: relative;
                }
                .navbar-cart-count {
                    position: absolute;
                    top: 0;
                    right: calc(50% - 20px);
                    background: var(--primary-color);
                    color: white;
                    font-size: 0.7rem;
                    width: 1.2rem;
                    height: 1.2rem;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
            `;
            document.head.appendChild(style);

            // Make sure cart object is created early
            if (!cart) {
                // Initialize cart if not already done
                cart = {
                    items: [],
                    total: 0,
                    // ... cart methods ...
                };
            }

            // Ensure cart-link works correctly
            const cartLink = document.getElementById('cart-link');
            if (cartLink) {
                cartLink.addEventListener('click', (e) => {
                    e.preventDefault();
                    const mobileCart = document.getElementById('mobile-cart');
                    const cartOverlay = document.getElementById('cart-overlay');
                    mobileCart.classList.add('active');
                    cartOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden'; // Prevent scrolling
                });
            }

            // Update cart display to ensure all count indicators are updated
            if (cart && cart.updateCartDisplay) {
                const originalUpdateCartDisplay = cart.updateCartDisplay;
                cart.updateCartDisplay = function() {
                    // Call original method first
                    originalUpdateCartDisplay.call(this);
                    
                    // Make sure all count indicators are updated
                    const navbarCartCount = document.getElementById('navbar-cart-count');
                    const itemCount = this.items.reduce((count, item) => count + item.quantity, 0);
                    
                    if (navbarCartCount) {
                        navbarCartCount.textContent = itemCount;
                    }
                };
                
                // Make sure cart display is updated at least once
                cart.updateCartDisplay();
            }
        });
    </script>

    <!-- Add JavaScript for the custom pizza functionality -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Custom pizza elements
            const customPizzaBtn = document.getElementById('custom-pizza-btn');
            const customPizzaModal = document.getElementById('custom-pizza-modal');
            const customPizzaOverlay = document.getElementById('custom-pizza-overlay');
            const closeCustomPizza = document.getElementById('close-custom-pizza');

            // Step navigation buttons
            const nextToSizeBtn = document.getElementById('next-to-size');
            const backToCrustBtn = document.getElementById('back-to-crust');
            const nextToToppingsBtn = document.getElementById('next-to-toppings');
            const backToSizeBtn = document.getElementById('back-to-size');
            const addCustomPizzaBtn = document.getElementById('add-custom-pizza');

            // Steps
            const step1 = document.getElementById('step-1');
            const step2 = document.getElementById('step-2');
            const step3 = document.getElementById('step-3');

            // Price tracking elements
            const currentPrice = document.getElementById('current-price');
            const selectedToppings = document.getElementById('selected-toppings');

            // Base prices for different sizes
            const sizePrices = {
                'Small': 10.99,
                'Medium': 13.99,
                'Large': 16.99,
                'Extra Large': 19.99
            };

            // Open custom pizza modal
            customPizzaBtn.addEventListener('click', function (e) {
                e.preventDefault();
                customPizzaModal.classList.add('active');
                customPizzaOverlay.classList.add('active');
                document.body.style.overflow = 'hidden'; // Prevent scrolling
            });

            // Close custom pizza modal
            closeCustomPizza.addEventListener('click', function () {
                customPizzaModal.classList.remove('active');
                customPizzaOverlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            customPizzaOverlay.addEventListener('click', function () {
                customPizzaModal.classList.remove('active');
                customPizzaOverlay.classList.remove('active');
                document.body.style.overflow = ''; // Restore scrolling
            });

            // Step navigation
            nextToSizeBtn.addEventListener('click', function () {
                step1.style.display = 'none';
                step2.style.display = 'block';
            });

            backToCrustBtn.addEventListener('click', function () {
                step2.style.display = 'none';
                step1.style.display = 'block';
            });

            nextToToppingsBtn.addEventListener('click', function () {
                step2.style.display = 'none';
                step3.style.display = 'block';
                updatePrice();
            });

            backToSizeBtn.addEventListener('click', function () {
                step3.style.display = 'none';
                step2.style.display = 'block';
            });

            // Update price based on size and toppings
            function updatePrice() {
                const selectedSize = document.querySelector('input[name="size"]:checked').value;
                const selectedCrust = document.querySelector('input[name="crust"]:checked').value;
                const toppings = document.querySelectorAll('input[name="toppings"]:checked');

                let basePrice = sizePrices[selectedSize];

                // Add gluten-free cost if selected
                if (selectedCrust === 'Gluten-Free') {
                    basePrice += 2;
                }

                // Calculate toppings cost (first 3 free, then $1.50 each)
                let toppingsCost = 0;
                if (toppings.length > 3) {
                    toppingsCost = (toppings.length - 3) * 1.5;
                }

                const totalPrice = basePrice + toppingsCost;

                // Update display
                currentPrice.textContent = `Current Price: $${totalPrice.toFixed(2)}`;
                selectedToppings.textContent = `Selected Toppings: ${toppings.length}/3 included${toppings.length > 3 ? ` (+${toppings.length - 3} extra)` : ''}`;
            }

            // Listen for changes in toppings and sizes
            document.querySelectorAll('input[name="toppings"]').forEach(input => {
                input.addEventListener('change', updatePrice);
            });

            document.querySelectorAll('input[name="size"]').forEach(input => {
                input.addEventListener('change', updatePrice);
            });

            document.querySelectorAll('input[name="crust"]').forEach(input => {
                input.addEventListener('change', updatePrice);
            });

            // Add custom pizza to cart
            addCustomPizzaBtn.addEventListener('click', function () {
                const selectedSize = document.querySelector('input[name="size"]:checked').value;
                const selectedCrust = document.querySelector('input[name="crust"]:checked').value;
                const selectedToppingsElements = document.querySelectorAll('input[name="toppings"]:checked');

                const toppingsArray = Array.from(selectedToppingsElements).map(el => el.value);

                let basePrice = sizePrices[selectedSize];

                // Add gluten-free cost if selected
                if (selectedCrust === 'Gluten-Free') {
                    basePrice += 2;
                }

                // Calculate toppings cost (first 3 free, then $1.50 each)
                let toppingsCost = 0;
                if (toppingsArray.length > 3) {
                    toppingsCost = (toppingsArray.length - 3) * 1.5;
                }

                const totalPrice = basePrice + toppingsCost;

                // Create pizza name
                let pizzaName = `Custom ${selectedSize} Pizza`;
                if (toppingsArray.length > 0) {
                    pizzaName += ` with ${toppingsArray.join(', ')}`;
                }
                pizzaName += ` (${selectedCrust} Crust)`;

                // Add to cart - using the global cart object
                if (cart) {
                    cart.addItem(100 + Math.floor(Math.random() * 900), pizzaName, totalPrice);

                    // Close modal
                    customPizzaModal.classList.remove('active');
                    customPizzaOverlay.classList.remove('active');
                    document.body.style.overflow = ''; // Restore scrolling

                    // Show confirmation
                    const addedMsg = document.createElement('div');
                    addedMsg.className = 'added-to-cart';
                    addedMsg.textContent = 'Custom pizza added to cart!';
                    addedMsg.style.position = 'fixed';
                    addedMsg.style.top = '20px';
                    addedMsg.style.left = '50%';
                    addedMsg.style.transform = 'translateX(-50%)';
                    addedMsg.style.background = 'var(--primary-color)';
                    addedMsg.style.color = 'white';
                    addedMsg.style.padding = '10px 20px';
                    addedMsg.style.borderRadius = '5px';
                    addedMsg.style.zIndex = '1000';
                    document.body.appendChild(addedMsg);

                    setTimeout(() => {
                        addedMsg.remove();
                    }, 2000);

                    // Reset form
                    document.getElementById('crust-thin').checked = true;
                    document.getElementById('size-small').checked = true;
                    document.querySelectorAll('input[name="toppings"]:checked').forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    step3.style.display = 'none';
                    step1.style.display = 'block';
                } else {
                    console.error('Cart not initialized');
                    alert('Sorry, there was an error adding your pizza to the cart. Please try again.');
                }
            });
        });
    </script>
</body>

</html>